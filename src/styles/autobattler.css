/* ── Autobattler Styles ──────────────────────────────────────────────────── */

.autobattler-container {
    height: 100%;
    overflow-y: auto;
    font-size: 11px;
    padding: 10px;
    color: var(--theme-window-content-text);
}

/* Phase transition wrapper */
.autobattler-container.phase-exit {
    animation: ab-phase-exit 0.15s ease-in forwards;
}

.autobattler-container.phase-enter {
    animation: ab-phase-enter 0.2s ease-out forwards;
}

@keyframes ab-phase-exit {
    0% {
        opacity: 1;
        transform: translateY(0);
    }

    100% {
        opacity: 0;
        transform: translateY(-6px);
    }
}

@keyframes ab-phase-enter {
    0% {
        opacity: 0;
        transform: translateY(6px);
    }

    100% {
        opacity: 1;
        transform: translateY(0);
    }
}

/* ── Section Headings ────────────────────────────────────────────────────── */

.ab-section-heading {
    font-size: 11px;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    margin: 0 0 6px;
    padding-bottom: 3px;
    border-bottom: 1px solid var(--theme-border-light);
    color: var(--theme-text-on-surface);
}

/* ── Lobby ────────────────────────────────────────────────────────────────── */

.ab-lobby h2.ab-title {
    margin: 0 0 2px;
    font-size: 18px;
    letter-spacing: 3px;
    text-transform: uppercase;
    animation: ab-title-glow 3s ease-in-out infinite;
}

@keyframes ab-title-glow {
    0%,
    100% {
        text-shadow: 0 0 4px rgb(100 149 237 / 0%);
    }

    50% {
        text-shadow:
            0 0 8px rgb(100 149 237 / 40%),
            0 0 16px rgb(100 149 237 / 15%);
    }
}

.ab-subtitle {
    font-style: italic;
    color: var(--theme-text-secondary);
    margin: 0 0 14px;
    font-size: 10px;
}

.ab-stats {
    display: flex;
    gap: 8px;
    margin-bottom: 14px;
    flex-wrap: wrap;
}

.ab-stat {
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: 6px 12px;
    background: var(--theme-surface-primary);
    border: 1px solid var(--theme-border-light);
    border-radius: 4px;
    min-width: 70px;
    transition:
        border-color 0.15s,
        box-shadow 0.15s;
}

.ab-stat:hover {
    border-color: var(--theme-accent);
    box-shadow: 0 1px 4px rgb(0 0 0 / 10%);
}

.ab-stat-icon {
    font-size: 14px;
    margin-bottom: 2px;
}

.ab-stat-label {
    font-size: 9px;
    color: var(--theme-text-secondary);
    text-transform: uppercase;
    letter-spacing: 0.3px;
}

.ab-stat-value {
    font-weight: 700;
    font-size: 14px;
}

/* ── Personal Bests ──────────────────────────────────────────────────────── */

.ab-personal-bests {
    margin-bottom: 12px;
}

.ab-bests-grid {
    display: flex;
    gap: 8px;
    flex-wrap: wrap;
}

.ab-best-item {
    display: flex;
    gap: 6px;
    align-items: baseline;
    padding: 4px 8px;
    background: var(--theme-surface-primary);
    border: 1px solid var(--theme-border-light);
    border-radius: 3px;
    font-size: 10px;
}

.ab-best-label {
    color: var(--theme-text-secondary);
}

.ab-best-value {
    font-weight: 700;
}

/* ── Career Bonuses ──────────────────────────────────────────────────────── */

.ab-bonuses {
    display: flex;
    flex-wrap: wrap;
    gap: 4px;
    align-items: center;
    margin-bottom: 10px;
}

.ab-bonuses-label {
    font-size: 10px;
    color: var(--theme-text-secondary);
    margin-right: 2px;
}

.ab-bonus-badge {
    font-size: 9px;
    font-weight: 700;
    color: var(--theme-color-success);
    padding: 1px 6px;
    background: rgb(34 139 34 / 10%);
    border: 1px solid rgb(34 139 34 / 25%);
    border-radius: 8px;
    white-space: nowrap;
}

.ab-start-btn {
    padding: 10px 36px;
    font-size: 14px;
    font-weight: 700;
    letter-spacing: 1px;
    background: linear-gradient(135deg, #2a4a7a, #4a7ab0);
    color: #ffffff;
    border: 1px solid #1a3a6a;
    border-radius: 4px;
    cursor: pointer;
    margin-bottom: 16px;
    box-shadow: 0 2px 6px rgb(42 74 122 / 30%);
    transition:
        filter 0.15s,
        box-shadow 0.15s,
        transform 0.15s;
    animation: ab-start-pulse 2.5s ease-in-out infinite;
}

@keyframes ab-start-pulse {
    0%,
    100% {
        box-shadow:
            0 2px 6px rgb(42 74 122 / 30%),
            0 0 0 0 rgb(74 122 176 / 0%);
    }

    50% {
        box-shadow:
            0 2px 6px rgb(42 74 122 / 30%),
            0 0 0 4px rgb(74 122 176 / 20%);
    }
}

.ab-start-btn:hover {
    filter: brightness(1.15);
    box-shadow: 0 4px 10px rgb(42 74 122 / 40%);
    transform: translateY(-1px);
    animation: none;
}

.ab-start-btn:active {
    filter: brightness(0.95);
    transform: translateY(0) scale(0.97);
    box-shadow: 0 1px 2px rgb(0 0 0 / 20%);
}

/* ── Collection ──────────────────────────────────────────────────────────── */

.ab-faction-group {
    margin-bottom: 12px;
}

.ab-faction-label {
    font-size: 11px;
    font-weight: 700;
    margin-bottom: 4px;
    cursor: pointer;
    user-select: none;
    padding-left: 6px;
    border-left: 3px solid var(--uc-faction-color, var(--theme-border-light));
    display: flex;
    align-items: center;
    gap: 6px;
}

.ab-faction-label .faction-progress {
    font-weight: 400;
    font-size: 10px;
    color: var(--theme-text-secondary);
    margin-left: auto;
}

.ab-faction-progress-bar {
    height: 3px;
    background: var(--theme-border-light);
    border-radius: 2px;
    margin: 2px 0 5px 6px;
    overflow: hidden;
}

.ab-faction-progress-fill {
    height: 100%;
    border-radius: 2px;
    background: var(--uc-faction-color, #808080);
    transition: width 0.4s ease;
}

.ab-collection-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(110px, 1fr));
    gap: 4px;
}

.ab-empty {
    color: var(--theme-text-secondary);
    font-style: italic;
    padding: 16px;
    text-align: center;
}

/* ── Bestiary Tabs ───────────────────────────────────────────────────────── */

.ab-bestiary-tabs {
    margin-top: 14px;
}

.ab-bestiary-tab-bar {
    display: flex;
    gap: 2px;
    border-bottom: 1px solid var(--theme-border-dark);
    margin-bottom: 0;
}

.ab-bestiary-tab {
    padding: 5px 14px;
    font-size: 11px;
    font-family: var(--theme-font-content);
    border: 1px solid var(--theme-border-dark);
    border-bottom: none;
    background: var(--theme-surface-primary);
    color: var(--theme-text-on-surface);
    cursor: pointer;
    position: relative;
    top: 1px;
    border-radius: 3px 3px 0 0;
}

.ab-bestiary-tab:hover {
    background: var(--theme-surface-elevated, var(--theme-surface-hover));
}

.ab-bestiary-tab.active {
    background: var(--theme-window-content-bg);
    border-bottom: 1px solid var(--theme-window-content-bg);
    font-weight: 700;
}

.ab-bestiary-pane {
    padding: 10px 0;
}

/* CSS fallback – inline styles are the primary visibility mechanism */
.ab-bestiary-pane:not(.active) {
    display: none;
}

/* ── Adversaries Tab ─────────────────────────────────────────────────────── */

.ab-adversary-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
    gap: 6px;
    margin-bottom: 12px;
}

.ab-adversary-card {
    border: 1px solid var(--theme-border-light);
    border-left: 3px solid var(--uc-faction-color, var(--theme-border-light));
    border-radius: 3px;
    padding: 6px 8px;
    background: var(--theme-surface-primary);
    opacity: 0.5;
    transition: opacity 0.2s;
}

.ab-adversary-card.defeated {
    opacity: 1;
}

.ab-adversary-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    gap: 4px;
}

.ab-adversary-name {
    font-weight: 700;
    font-size: 11px;
}

.ab-adversary-faction {
    font-size: 10px;
    color: var(--theme-text-secondary);
    margin-top: 2px;
}

.ab-boss-badge {
    font-size: 9px;
    padding: 1px 5px;
    border-radius: 2px;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.3px;
}

.ab-boss-badge.defeated {
    background: rgb(76 175 80 / 20%);
    color: #4caf50;
}

.ab-boss-badge.undefeated {
    background: rgb(158 158 158 / 15%);
    color: var(--theme-text-secondary);
}

.ab-opponent-schools {
    display: flex;
    flex-wrap: wrap;
    gap: 6px;
    margin-bottom: 8px;
}

.ab-opponent-school {
    display: flex;
    align-items: center;
    gap: 4px;
    padding: 4px 8px;
    border: 1px solid var(--theme-border-light);
    border-left: 3px solid var(--uc-faction-color, var(--theme-border-light));
    border-radius: 3px;
    background: var(--theme-surface-primary);
    font-size: 11px;
}

.ab-opponent-icon {
    font-size: 13px;
}

.ab-opponent-label {
    font-weight: 600;
}

/* ── Relics Tab ──────────────────────────────────────────────────────────── */

.ab-relic-tier-section {
    margin-bottom: 12px;
}

.ab-relic-tier-section .ab-section-heading {
    margin-top: 0;
}

.ab-relic-count {
    font-weight: 400;
    font-size: 10px;
    color: var(--theme-text-secondary);
}

.ab-relic-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
    gap: 5px;
}

.ab-relic-entry {
    border: 1px solid var(--theme-border-light);
    border-radius: 3px;
    padding: 6px 8px;
    background: var(--theme-surface-primary);
    transition: border-color 0.2s, background 0.2s;
}

.ab-relic-entry.locked {
    opacity: 0.45;
    border-style: dashed;
}

.ab-relic-entry.unlocked.relic-common {
    border-left: 3px solid #9e9e9e;
}

.ab-relic-entry.unlocked.relic-rare {
    border-left: 3px solid #42a5f5;
}

.ab-relic-entry.unlocked.relic-legendary {
    border-left: 3px solid #ffa726;
}

.ab-relic-entry.unlocked.relic-secret {
    border-left: 3px solid #ab47bc;
}

.ab-relic-name {
    font-weight: 700;
    font-size: 11px;
    margin-bottom: 2px;
}

.ab-relic-desc {
    font-size: 10px;
    color: var(--theme-text-secondary);
    line-height: 1.3;
}

/* New unit highlight */
.uc-card.uc-new-unlock {
    border-color: #d4a017;
    box-shadow: 0 0 6px 1px rgb(212 160 23 / 30%);
    position: relative;
}

.uc-new-badge {
    position: absolute;
    top: -2px;
    right: -2px;
    font-size: 7px;
    font-weight: 700;
    color: #ffffff;
    background: #d4a017;
    padding: 1px 4px;
    border-radius: 2px;
    letter-spacing: 0.5px;
    text-transform: uppercase;
    animation: ab-new-badge-pulse 1.5s ease-in-out infinite;
}

@keyframes ab-new-badge-pulse {
    0%,
    100% {
        opacity: 1;
    }

    50% {
        opacity: 0.7;
    }
}

/* ── Run Header ──────────────────────────────────────────────────────────── */

.ab-run-header {
    display: flex;
    justify-content: space-between;
    padding: 0;
    background: linear-gradient(135deg, #2a2a2a, #3a3a3a);
    color: #ffffff;
    font-weight: 700;
    margin-bottom: 10px;
    font-size: 11px;
    border-radius: 4px;
    overflow: hidden;
    border: 1px solid #444444;
}

.ab-run-header.boss {
    background: linear-gradient(135deg, #4a1a1a, #6a2a2a);
    border-color: #8a3a3a;
    animation: ab-boss-header-glow 2s ease-in-out infinite;
}

@keyframes ab-boss-header-glow {
    0%,
    100% {
        box-shadow: 0 0 0 0 rgb(200 50 50 / 0%);
    }

    50% {
        box-shadow: 0 0 8px 1px rgb(200 50 50 / 20%);
    }
}

.ab-header-cell {
    padding: 7px 12px;
    border-right: 1px solid rgb(255 255 255 / 10%);
}

.ab-header-cell:last-child {
    border-right: none;
}

/* Lives animation */
.ab-lives {
    letter-spacing: 1px;
}

.ab-lives .heart-lost {
    display: inline-block;
    animation: ab-heart-break 0.5s ease-out forwards;
    color: #cc4444;
}

@keyframes ab-heart-break {
    0% {
        transform: scale(1);
        opacity: 1;
    }

    30% {
        transform: scale(1.4);
        opacity: 1;
    }

    100% {
        transform: scale(1);
        opacity: 0.5;
    }
}

/* ── Shop Section ────────────────────────────────────────────────────────── */

.ab-shop-section {
    background: var(--theme-surface-primary);
    border: 1px solid var(--theme-border-light);
    border-radius: 4px;
    padding: 8px;
    margin-bottom: 10px;
}

.ab-shop-section .ab-section-heading {
    margin-top: 0;
}

.ab-shop-offers {
    display: flex;
    gap: 6px;
    margin-bottom: 8px;
}

/* Reroll animation */
.ab-shop-offers.ab-reroll-anim > .uc-card {
    animation: ab-reroll-flip 0.35s ease-in-out;
}

@keyframes ab-reroll-flip {
    0% {
        opacity: 1;
        transform: rotateY(0deg) scale(1);
    }

    40% {
        opacity: 0;
        transform: rotateY(90deg) scale(0.9);
    }

    60% {
        opacity: 0;
        transform: rotateY(-90deg) scale(0.9);
    }

    100% {
        opacity: 1;
        transform: rotateY(0deg) scale(1);
    }
}

.ab-shop-actions {
    display: flex;
    gap: 6px;
    align-items: center;
}

.ab-reroll-btn {
    padding: 5px 14px;
    font-size: 10px;
    font-weight: 600;
    border: 1px solid var(--theme-border-dark);
    background: var(--theme-surface-primary);
    border-radius: 4px;
    cursor: pointer;
    transition:
        background 0.15s,
        transform 0.1s,
        box-shadow 0.15s;
}

.ab-reroll-btn:hover:not(:disabled) {
    background: var(--theme-surface-secondary);
    box-shadow: 0 1px 3px rgb(0 0 0 / 10%);
}

.ab-reroll-btn:active:not(:disabled) {
    transform: scale(0.95);
}

.ab-reroll-btn:disabled {
    opacity: 0.5;
    cursor: not-allowed;
}

/* Scrap change float */
.ab-scrap-float {
    position: absolute;
    font-size: 12px;
    font-weight: 700;
    pointer-events: none;
    animation: ab-scrap-float 0.8s ease-out forwards;
    z-index: 10;
}

.ab-scrap-float.positive {
    color: #44aa44;
}

.ab-scrap-float.negative {
    color: #cc4444;
}

@keyframes ab-scrap-float {
    0% {
        opacity: 1;
        transform: translateY(0);
    }

    100% {
        opacity: 0;
        transform: translateY(-18px);
    }
}

/* Level up floating text */
.ab-level-up-float {
    position: absolute;
    top: -8px;
    left: 50%;
    transform: translateX(-50%);
    font-size: 10px;
    font-weight: 900;
    color: #d4a017;
    text-shadow: 0 0 4px rgb(212 160 23 / 60%);
    pointer-events: none;
    white-space: nowrap;
    animation: ab-level-up-float 1s ease-out forwards;
    z-index: 10;
}

@keyframes ab-level-up-float {
    0% {
        opacity: 1;
        transform: translateX(-50%) translateY(0) scale(0.8);
    }

    30% {
        opacity: 1;
        transform: translateX(-50%) translateY(-6px) scale(1.1);
    }

    100% {
        opacity: 0;
        transform: translateX(-50%) translateY(-16px) scale(1);
    }
}

/* ── Synergy Bar ─────────────────────────────────────────────────────────── */

.ab-synergy-bar {
    display: flex;
    gap: 6px;
    margin-bottom: 10px;
    flex-wrap: wrap;
}

.ab-synergy-badge {
    display: inline-flex;
    align-items: center;
    gap: 4px;
    padding: 3px 10px;
    font-size: 10px;
    font-weight: 700;
    background: color-mix(
        in srgb,
        var(--uc-faction-color, #6495ed) 10%,
        transparent
    );
    border: 1px solid
        color-mix(in srgb, var(--uc-faction-color, #6495ed) 30%, transparent);
    border-radius: 12px;
    transition:
        transform 0.15s,
        box-shadow 0.15s;
}

.ab-synergy-badge:hover {
    transform: scale(1.05);
    box-shadow: 0 1px 4px
        color-mix(in srgb, var(--uc-faction-color, #6495ed) 25%, transparent);
}

.ab-synergy-badge.ab-synergy-highlight {
    animation: ab-synergy-pulse 0.5s ease-out;
}

@keyframes ab-synergy-pulse {
    0% {
        transform: scale(1);
        box-shadow: 0 0 0 0
            color-mix(
                in srgb,
                var(--uc-faction-color, #6495ed) 40%,
                transparent
            );
    }

    50% {
        transform: scale(1.1);
        box-shadow: 0 0 8px 2px
            color-mix(
                in srgb,
                var(--uc-faction-color, #6495ed) 30%,
                transparent
            );
    }

    100% {
        transform: scale(1);
        box-shadow: none;
    }
}

/* ── Unit Card Component ─────────────────────────────────────────────────── */

.uc-card {
    padding: 7px 9px;
    border: 1px solid var(--theme-border-light);
    background: linear-gradient(
        145deg,
        var(--theme-surface-primary) 60%,
        color-mix(
            in srgb,
            var(--uc-faction-color, #808080) 8%,
            var(--theme-surface-primary)
        )
    );
    font-size: 10px;
    position: relative;
    border-left: 3px solid var(--uc-faction-color, #808080);
    min-width: 95px;
    text-align: left;
    border-radius: 4px;
    overflow: hidden;
}

/* Tier ribbon */
.uc-tier-ribbon {
    position: absolute;
    top: 0;
    right: 0;
    font-size: 7px;
    font-weight: 700;
    padding: 1px 5px;
    letter-spacing: 0.5px;
    border-radius: 0 3px 0 4px;
    line-height: 1.3;
}

.uc-tier-1 .uc-tier-ribbon {
    background: rgb(128 128 128 / 20%);
    color: var(--theme-text-secondary);
}

.uc-tier-2 .uc-tier-ribbon {
    background: rgb(100 149 237 / 25%);
    color: #6495ed;
}

.uc-tier-3 .uc-tier-ribbon {
    background: rgb(212 160 23 / 25%);
    color: #d4a017;
}

/* Level glow effects */
.uc-card.uc-level-2 {
    border-color: var(--uc-faction-color, #808080);
    box-shadow: inset 0 0 0 1px rgb(192 192 192 / 30%);
    animation: uc-level2-shimmer 4s ease-in-out infinite;
}

@keyframes uc-level2-shimmer {
    0%,
    100% {
        box-shadow: inset 0 0 0 1px rgb(192 192 192 / 20%);
    }

    50% {
        box-shadow:
            inset 0 0 0 1px rgb(192 192 192 / 45%),
            0 0 4px rgb(192 192 192 / 15%);
    }
}

.uc-card.uc-level-3 {
    border-color: var(--uc-faction-color, #808080);
    box-shadow: inset 0 0 0 1px rgb(212 160 23 / 40%);
    animation: uc-level3-shimmer 3s ease-in-out infinite;
}

@keyframes uc-level3-shimmer {
    0%,
    100% {
        box-shadow:
            inset 0 0 0 1px rgb(212 160 23 / 30%),
            0 0 4px rgb(212 160 23 / 10%);
    }

    50% {
        box-shadow:
            inset 0 0 0 1px rgb(212 160 23 / 60%),
            0 0 8px rgb(212 160 23 / 25%);
    }
}

/* Shop card */
.uc-card.uc-shop {
    flex: 1;
    cursor: pointer;
    transition:
        background 0.15s,
        box-shadow 0.15s,
        transform 0.15s;
}

.uc-card.uc-shop:hover:not(.sold, .unaffordable) {
    background: linear-gradient(
        145deg,
        var(--theme-surface-secondary) 60%,
        color-mix(
            in srgb,
            var(--uc-faction-color, #808080) 12%,
            var(--theme-surface-secondary)
        )
    );
    box-shadow: 0 2px 8px rgb(0 0 0 / 18%);
    transform: translateY(-2px) scale(1.02);
}

.uc-card.uc-shop.sold {
    opacity: 0.35;
    cursor: default;
    filter: grayscale(0.6);
}

.uc-card.uc-shop.unaffordable {
    opacity: 0.55;
    cursor: not-allowed;
}

/* Shop card purchase animation */
.uc-card.uc-shop.uc-purchase-anim {
    animation: uc-purchase-fly 0.3s ease-in forwards;
    pointer-events: none;
}

@keyframes uc-purchase-fly {
    0% {
        opacity: 1;
        transform: scale(1);
    }

    50% {
        opacity: 0.6;
        transform: scale(0.85) translateY(10px);
    }

    100% {
        opacity: 0;
        transform: scale(0.6) translateY(30px);
    }
}

/* Sell animation */
.uc-card.uc-sell-anim {
    animation: uc-sell-dissolve 0.3s ease-out forwards;
    pointer-events: none;
}

@keyframes uc-sell-dissolve {
    0% {
        opacity: 1;
        transform: scale(1);
    }

    50% {
        opacity: 0.5;
        transform: scale(0.9);
        filter: brightness(1.5);
    }

    100% {
        opacity: 0;
        transform: scale(0.7);
    }
}

/* Owned card */
.uc-card.uc-owned {
    cursor: grab;
    transition:
        box-shadow 0.15s,
        transform 0.15s;
}

.uc-card.uc-owned:hover {
    box-shadow:
        0 0 0 2px var(--uc-faction-color, #808080),
        0 2px 6px rgb(0 0 0 / 15%);
    transform: translateY(-2px) scale(1.03);
}

.uc-card.uc-owned.dragging {
    opacity: 0.35;
}

/* Level-up merge animation */
.uc-card.uc-level-up-burst {
    animation: uc-level-up 0.6s ease-out;
}

@keyframes uc-level-up {
    0% {
        transform: scale(1);
        box-shadow: 0 0 0 0 rgb(212 160 23 / 60%);
    }

    30% {
        transform: scale(1.15);
        box-shadow: 0 0 16px 4px rgb(212 160 23 / 50%);
    }

    100% {
        transform: scale(1);
        box-shadow: 0 0 0 0 rgb(212 160 23 / 0%);
    }
}

/* Combat card */
.uc-card.uc-combat {
    min-width: 82px;
    transition:
        transform 0.2s,
        opacity 0.3s,
        filter 0.3s;
}

.uc-card.uc-combat.uc-front-unit {
    box-shadow:
        0 0 0 2px var(--uc-faction-color, #808080),
        0 0 6px 1px rgb(255 255 255 / 15%);
}

.uc-card.uc-combat.dead {
    opacity: 0;
    transform: scale(0.6) rotate(8deg);
    filter: brightness(2) saturate(0);
    transition: all 0.4s ease-out;
}

.uc-card.uc-combat.attacking {
    animation: uc-attack 0.3s ease-out;
}

.uc-card.uc-combat.hit {
    animation: uc-hit 0.25s ease-out;
}

.uc-card.uc-combat.buffed {
    animation: uc-buff 0.4s ease-out;
}

.uc-card.uc-combat.summoned,
.uc-card.uc-combat.uc-summon-enter {
    animation: uc-summon 0.4s ease-out;
}

/* Collection card */
.uc-card.uc-collection {
    font-size: 9px;
    transition:
        transform 0.15s,
        box-shadow 0.15s;
}

.uc-card.uc-collection:hover {
    transform: translateY(-1px);
    box-shadow: 0 2px 6px rgb(0 0 0 / 12%);
}

/* ── Card subcomponents ──────────────────────────────────────────────────── */

.uc-header {
    display: flex;
    justify-content: space-between;
    align-items: baseline;
    gap: 4px;
}

.uc-name {
    font-weight: 700;
    font-size: 10.5px;
    line-height: 1.2;
}

.uc-level {
    font-size: 10px;
    color: var(--theme-color-warning);
    white-space: nowrap;
    text-shadow: 0 0 3px rgb(212 160 23 / 30%);
}

.uc-body {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-top: 3px;
    gap: 4px;
}

/* Colored individual stats */
.uc-stat-atk {
    font-weight: 700;
    font-size: 11px;
    color: #cc4444;
}

.uc-stat-hp {
    font-weight: 700;
    font-size: 11px;
    color: #44aa44;
}

/* Legacy uc-stats class (fallback) */
.uc-stats {
    font-weight: 700;
    color: var(--theme-text-on-surface);
    font-size: 10px;
}

.uc-shield {
    font-size: 10px;
    color: #6495ed;
    font-weight: 700;
}

.uc-faction {
    font-size: 10px;
}

.uc-ability {
    font-size: 8.5px;
    color: var(--theme-text-secondary);
    margin-top: 4px;
    font-style: italic;
    line-height: 1.3;
}

.uc-trigger-icon {
    font-style: normal;
    font-size: 9px;
}

.uc-cost {
    font-weight: 700;
    margin-top: 4px;
    color: var(--theme-text-on-surface);
    font-size: 11px;
}

.uc-sell-btn {
    position: absolute;
    top: 2px;
    right: 2px;
    font-size: 8px;
    padding: 1px 4px;
    cursor: pointer;
    border: 1px solid var(--theme-border-dark);
    background: var(--theme-surface-primary);
    color: var(--theme-color-danger);
    border-radius: 2px;
    opacity: 0;
    transition: opacity 0.15s;
}

.uc-card.uc-owned:hover .uc-sell-btn {
    opacity: 1;
}

.uc-slot-label {
    position: absolute;
    top: -1px;
    left: 2px;
    font-size: 8px;
    color: var(--theme-text-secondary);
    font-weight: 700;
}

/* Front line slot marker */
.uc-slot-label.uc-front-marker {
    color: var(--theme-color-warning);
    text-shadow: 0 0 3px rgb(212 160 23 / 30%);
}

/* Health bar */
.uc-hp-bar {
    height: 5px;
    background: var(--theme-border-dark);
    margin-top: 3px;
    border-radius: 3px;
    overflow: hidden;
}

.uc-hp-fill {
    height: 100%;
    border-radius: 3px;
    transition:
        width 0.3s ease,
        background 0.3s ease;
}

.uc-hp-text {
    font-size: 8px;
    text-align: center;
    margin-top: 1px;
    color: var(--theme-text-secondary);
}

/* Empty slot (drop target) */
.uc-slot-empty {
    min-width: 95px;
    min-height: 62px;
    border: 2px dashed var(--theme-border-light);
    display: flex;
    align-items: center;
    justify-content: center;
    opacity: 0.45;
    border-radius: 4px;
    transition:
        border-color 0.15s,
        background 0.15s,
        opacity 0.15s,
        box-shadow 0.15s;
}

.uc-slot-empty.drag-over {
    border-color: var(--theme-color-warning);
    border-style: solid;
    background: rgb(212 160 23 / 10%);
    opacity: 1;
    box-shadow: inset 0 0 8px rgb(212 160 23 / 15%);
}

/* ── Lineup / Bench ──────────────────────────────────────────────────────── */

.ab-lineup-hint {
    font-size: 9px;
    color: var(--theme-text-secondary);
    font-weight: 400;
    margin-left: 6px;
    text-transform: none;
    letter-spacing: 0;
}

.ab-lineup-grid {
    display: flex;
    gap: 5px;
    margin-bottom: 10px;
    min-height: 72px;
    padding: 8px;
    background: linear-gradient(
        180deg,
        rgb(34 139 34 / 4%) 0%,
        rgb(0 0 0 / 4%) 100%
    );
    border: 1px solid var(--theme-border-light);
    border-radius: 4px;
    box-shadow: inset 0 1px 3px rgb(0 0 0 / 6%);
    position: relative;
}

/* Front line indicator */
.ab-lineup-grid::before {
    content: "FRONT";
    position: absolute;
    top: -1px;
    left: 8px;
    font-size: 7px;
    font-weight: 700;
    letter-spacing: 1px;
    color: var(--theme-color-warning);
    opacity: 0.6;
}

.ab-bench-heading {
    margin-top: 4px;
}

.ab-bench-grid {
    display: flex;
    gap: 5px;
    min-height: 44px;
    padding: 8px;
    margin-bottom: 10px;
    background: rgb(0 0 0 / 3%);
    border: 1px dashed var(--theme-border-light);
    border-radius: 4px;
    transition:
        border-color 0.15s,
        background 0.15s;
}

.ab-bench-grid.drag-over {
    border-color: var(--theme-color-warning);
    border-style: solid;
    background: rgb(212 160 23 / 6%);
}

.ab-bench-empty {
    font-size: 9px;
    color: var(--theme-text-secondary);
    padding: 4px;
    font-style: italic;
}

/* ── Opponent Preview ────────────────────────────────────────────────────── */

.ab-opponent-preview {
    margin-bottom: 10px;
    padding: 8px;
    background: rgb(204 0 0 / 4%);
    border: 1px solid rgb(204 0 0 / 15%);
    border-radius: 3px;
}

.ab-opponent-preview .ab-section-heading {
    border-bottom-color: rgb(204 0 0 / 20%);
    color: var(--theme-color-danger);
}

.ab-preview-header {
    display: flex;
    justify-content: space-between;
    align-items: baseline;
    margin-bottom: 6px;
    font-size: 10px;
}

.ab-preview-name {
    font-weight: 700;
}

.ab-preview-faction {
    color: var(--theme-text-secondary);
}

.ab-boss-modifier {
    display: flex;
    align-items: center;
    gap: 6px;
    padding: 3px 8px;
    margin: 4px 0;
    border-radius: 4px;
    font-size: 10px;
    background: var(--theme-bg-tertiary, rgb(255 165 0 / 8%));
    border-left: 2px solid var(--theme-color-warning, orange);
}

.ab-boss-modifier .ab-modifier-name {
    font-weight: 700;
    color: var(--theme-color-warning, orange);
}

.ab-boss-modifier .ab-modifier-desc {
    color: var(--theme-text-secondary);
}

.ab-boss-modifier.compact {
    display: inline-flex;
    margin: 0 0 0 6px;
    padding: 1px 6px;
    font-size: 9px;
    vertical-align: middle;
}

.ab-preview-units {
    display: flex;
    gap: 4px;
    flex-wrap: wrap;
}

/* ── Actions ──────────────────────────────────────────────────────────────── */

.ab-actions {
    display: flex;
    justify-content: center;
    padding: 10px 0;
}

.ab-fight-btn {
    padding: 10px 40px;
    font-size: 15px;
    font-weight: 700;
    letter-spacing: 1px;
    background: linear-gradient(135deg, #cc3333, #ee5555);
    color: #ffffff;
    border: 1px solid #aa2222;
    border-radius: 4px;
    cursor: pointer;
    box-shadow: 0 2px 6px rgb(204 51 51 / 30%);
    transition:
        filter 0.15s,
        box-shadow 0.15s,
        transform 0.15s;
}

.ab-fight-btn:hover:not(:disabled) {
    filter: brightness(1.15);
    box-shadow: 0 4px 12px rgb(204 51 51 / 40%);
    transform: translateY(-2px);
}

.ab-fight-btn:active:not(:disabled) {
    transform: translateY(0) scale(0.97);
    box-shadow: 0 1px 2px rgb(0 0 0 / 20%);
}

.ab-fight-btn:disabled {
    opacity: 0.5;
    cursor: not-allowed;
}

.ab-fight-btn.boss {
    background: linear-gradient(135deg, #6a1a1a, #bb3333, #8a2a2a);
    background-size: 200% 200%;
    border-color: #6a1a1a;
    text-shadow: 0 1px 3px rgb(0 0 0 / 50%);
    animation:
        boss-pulse 2s ease-in-out infinite,
        boss-gradient 3s ease-in-out infinite;
}

@keyframes boss-pulse {
    0%,
    100% {
        box-shadow:
            0 2px 6px rgb(0 0 0 / 25%),
            0 0 0 0 rgb(200 50 50 / 0%);
    }

    50% {
        box-shadow:
            0 2px 6px rgb(0 0 0 / 25%),
            0 0 16px 3px rgb(200 50 50 / 35%);
    }
}

@keyframes boss-gradient {
    0%,
    100% {
        background-position: 0% 50%;
    }

    50% {
        background-position: 100% 50%;
    }
}

/* ── Tooltip ─────────────────────────────────────────────────────────────── */

.ab-tooltip {
    position: fixed;
    z-index: 10001;
    background: var(--theme-terminal-bg, #1a1a2e);
    color: var(--theme-terminal-text, #e0e0e0);
    border: 1px solid var(--theme-border-dark);
    border-radius: 4px;
    padding: 6px 8px;
    font-size: 10px;
    max-width: 200px;
    box-shadow: 0 2px 8px rgb(0 0 0 / 40%);
    pointer-events: none;
}

.ab-tooltip-name {
    font-weight: 700;
    font-size: 11px;
    margin-bottom: 3px;
}

.ab-tooltip-ability {
    font-style: italic;
    color: var(--theme-terminal-info, #87ceeb);
    margin-bottom: 2px;
    line-height: 1.3;
}

.ab-tooltip-bonus {
    font-size: 9px;
    color: var(--theme-terminal-success, #90ee90);
    margin-top: 2px;
}

/* ── Combat Arena ────────────────────────────────────────────────────────── */

.ab-combat-arena {
    display: flex;
    flex-direction: column;
    gap: 4px;
    padding: 8px;
    margin-bottom: 8px;
    position: relative;
}

/* Screen shake on big hits */
.ab-combat-arena.ab-screen-shake {
    animation: ab-shake 0.3s ease-out;
}

@keyframes ab-shake {
    0% {
        transform: translate(0, 0);
    }

    15% {
        transform: translate(-3px, 1px);
    }

    30% {
        transform: translate(3px, -1px);
    }

    45% {
        transform: translate(-2px, -1px);
    }

    60% {
        transform: translate(2px, 1px);
    }

    75% {
        transform: translate(-1px, 0);
    }

    100% {
        transform: translate(0, 0);
    }
}

/* Boss battle atmosphere */
.ab-combat-arena.ab-boss-arena {
    background: radial-gradient(
        ellipse at center,
        transparent 40%,
        rgb(200 50 50 / 8%) 100%
    );
    border-radius: 4px;
}

.ab-combat-arena.ab-boss-arena::before {
    content: "";
    position: absolute;
    inset: 0;
    border-radius: 4px;
    pointer-events: none;
    box-shadow: inset 0 0 20px 4px rgb(200 50 50 / 10%);
}

/* Round indicator in combat */
.ab-combat-round {
    text-align: center;
    font-size: 9px;
    font-weight: 700;
    color: var(--theme-text-secondary);
    letter-spacing: 1px;
    text-transform: uppercase;
    padding: 2px 0;
}

.ab-combat-round.ab-round-pulse {
    animation: ab-round-pulse 0.4s ease-out;
}

@keyframes ab-round-pulse {
    0% {
        transform: scale(1);
        opacity: 0.5;
    }

    50% {
        transform: scale(1.15);
        opacity: 1;
    }

    100% {
        transform: scale(1);
        opacity: 1;
    }
}

.ab-arena-side {
    display: flex;
    gap: 5px;
    padding: 8px;
    border: 1px solid var(--theme-border-dark);
    min-height: 74px;
    align-items: flex-start;
    border-radius: 4px;
    position: relative;
}

.ab-arena-side.player {
    background: linear-gradient(
        180deg,
        rgb(34 139 34 / 6%) 0%,
        rgb(34 139 34 / 2%) 100%
    );
    border-color: rgb(34 139 34 / 40%);
    flex-direction: row;
}

.ab-arena-side.opponent {
    background: linear-gradient(
        180deg,
        rgb(204 0 0 / 6%) 0%,
        rgb(204 0 0 / 2%) 100%
    );
    border-color: rgb(204 0 0 / 40%);
    flex-direction: row-reverse;
}

.ab-arena-label {
    writing-mode: vertical-lr;
    text-orientation: mixed;
    font-size: 9px;
    font-weight: 700;
    color: var(--theme-text-secondary);
    padding: 0 4px;
    opacity: 0.7;
}

.ab-arena-vs {
    text-align: center;
    font-weight: 700;
    font-size: 13px;
    color: var(--theme-text-secondary);
    padding: 2px 0;
    letter-spacing: 2px;
}

/* Ability callout floating label */
.uc-ability-callout {
    position: absolute;
    top: -14px;
    left: 50%;
    transform: translateX(-50%);
    font-size: 8px;
    font-weight: 700;
    color: #6495ed;
    text-shadow: 0 0 4px rgb(100 149 237 / 40%);
    white-space: nowrap;
    pointer-events: none;
    animation: uc-ability-callout 0.8s ease-out forwards;
    z-index: 10;
}

@keyframes uc-ability-callout {
    0% {
        opacity: 0;
        transform: translateX(-50%) translateY(4px) scale(0.8);
    }

    20% {
        opacity: 1;
        transform: translateX(-50%) translateY(0) scale(1);
    }

    80% {
        opacity: 1;
        transform: translateX(-50%) translateY(-2px);
    }

    100% {
        opacity: 0;
        transform: translateX(-50%) translateY(-8px);
    }
}

/* ── Combat Log ──────────────────────────────────────────────────────────── */

.ab-log-details {
    margin: 8px 0;
    text-align: left;
}

.ab-log-details > summary {
    cursor: pointer;
    font-size: 10px;
    color: var(--theme-text-secondary);
    padding: 4px 0;
}

.ab-combat-log {
    text-align: left;
    max-height: 120px;
    overflow-y: auto;
    background: var(--theme-terminal-bg);
    color: var(--theme-terminal-text);
    padding: 6px;
    font-family: monospace;
    font-size: 9px;
    margin: 4px 0 0;
    border: 1px solid var(--theme-border-dark);
    border-radius: 3px;
}

.ab-log-entry {
    margin-bottom: 1px;
}

.ab-log-entry.death {
    color: var(--theme-terminal-error);
}

.ab-log-entry.buff {
    color: var(--theme-terminal-success);
}

.ab-log-entry.summon {
    color: var(--theme-terminal-info);
}

/* ── Combat controls ─────────────────────────────────────────────────────── */

.ab-combat-controls {
    display: flex;
    justify-content: center;
    gap: 6px;
    margin: 8px 0;
}

.ab-speed-btn,
.ab-skip-btn {
    padding: 4px 14px;
    font-size: 10px;
    font-weight: 600;
    border: 1px solid var(--theme-border-dark);
    background: var(--theme-surface-primary);
    border-radius: 4px;
    cursor: pointer;
    transition:
        background 0.15s,
        transform 0.1s,
        box-shadow 0.15s;
}

.ab-speed-btn:hover,
.ab-skip-btn:hover {
    background: var(--theme-surface-secondary);
    box-shadow: 0 1px 3px rgb(0 0 0 / 10%);
}

.ab-speed-btn:active,
.ab-skip-btn:active {
    transform: scale(0.95);
}

.ab-speed-btn.active {
    background: var(--theme-accent);
    color: #ffffff;
    border-color: var(--theme-accent);
}

/* ── Combat result ───────────────────────────────────────────────────────── */

.ab-combat-result {
    text-align: center;
    padding: 14px;
    position: relative;
    overflow: hidden;
}

.ab-combat-result h2 {
    font-size: 20px;
    margin: 0 0 6px;
    letter-spacing: 2px;
    animation: ab-result-title 0.5s ease-out;
}

@keyframes ab-result-title {
    0% {
        opacity: 0;
        transform: scale(0.7);
    }

    60% {
        opacity: 1;
        transform: scale(1.08);
    }

    100% {
        opacity: 1;
        transform: scale(1);
    }
}

.ab-combat-result.victory h2 {
    color: var(--theme-color-success);
    text-shadow: 0 0 8px rgb(34 139 34 / 30%);
    animation:
        ab-result-title 0.5s ease-out,
        ab-victory-glow 2s ease-in-out 0.5s infinite;
}

@keyframes ab-victory-glow {
    0%,
    100% {
        text-shadow: 0 0 8px rgb(34 139 34 / 30%);
    }

    50% {
        text-shadow:
            0 0 16px rgb(34 139 34 / 50%),
            0 0 24px rgb(212 160 23 / 20%);
    }
}

.ab-combat-result.defeat h2 {
    color: var(--theme-color-danger);
    text-shadow: 0 0 6px rgb(204 0 0 / 25%);
}

.ab-combat-result.draw h2 {
    color: var(--theme-color-warning);
}

/* Victory confetti */
.ab-combat-result.victory::before,
.ab-combat-result.victory::after {
    content: "";
    position: absolute;
    top: -10px;
    width: 6px;
    height: 6px;
    pointer-events: none;
}

.ab-combat-result.victory .ab-confetti-container {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 60px;
    pointer-events: none;
    overflow: hidden;
}

.ab-confetti {
    position: absolute;
    width: 4px;
    height: 4px;
    border-radius: 1px;
    animation: ab-confetti-fall 1.5s ease-in forwards;
    opacity: 0;
}

@keyframes ab-confetti-fall {
    0% {
        opacity: 1;
        transform: translateY(-10px) rotate(0deg);
    }

    100% {
        opacity: 0;
        transform: translateY(60px) rotate(360deg);
    }
}

/* Defeat vignette */
.ab-combat-result.defeat::before {
    content: "";
    position: absolute;
    inset: 0;
    pointer-events: none;
    box-shadow: inset 0 0 30px 10px rgb(204 0 0 / 12%);
    animation: ab-defeat-vignette 0.6s ease-out;
    border-radius: 4px;
}

@keyframes ab-defeat-vignette {
    0% {
        opacity: 0;
    }

    30% {
        opacity: 1;
        box-shadow: inset 0 0 40px 15px rgb(204 0 0 / 20%);
    }

    100% {
        opacity: 1;
        box-shadow: inset 0 0 30px 10px rgb(204 0 0 / 12%);
    }
}

/* Win streak display */
.ab-win-streak {
    display: inline-flex;
    align-items: center;
    gap: 4px;
    padding: 3px 10px;
    font-size: 10px;
    font-weight: 700;
    color: #d4a017;
    background: rgb(212 160 23 / 10%);
    border: 1px solid rgb(212 160 23 / 25%);
    border-radius: 12px;
    margin-bottom: 8px;
    animation: ab-streak-glow 1.5s ease-in-out infinite;
}

@keyframes ab-streak-glow {
    0%,
    100% {
        box-shadow: 0 0 0 0 rgb(212 160 23 / 0%);
    }

    50% {
        box-shadow: 0 0 6px 1px rgb(212 160 23 / 25%);
    }
}

.ab-combat-subtitle {
    font-size: 11px;
    color: var(--theme-text-secondary);
    margin-bottom: 8px;
}

/* Staggered reward animation */
.ab-reward.ab-reward-enter {
    animation: ab-reward-slide-in 0.3s ease-out forwards;
    opacity: 0;
}

@keyframes ab-reward-slide-in {
    0% {
        opacity: 0;
        transform: translateX(-12px);
    }

    100% {
        opacity: 1;
        transform: translateX(0);
    }
}

/* New unit unlock fanfare */
.ab-reward.ab-reward-unit-unlock {
    border-left-color: #d4a017;
    background: rgb(212 160 23 / 10%);
    animation:
        ab-reward-slide-in 0.3s ease-out forwards,
        ab-unlock-sparkle 1.5s ease-in-out 0.3s infinite;
}

@keyframes ab-unlock-sparkle {
    0%,
    100% {
        box-shadow: none;
    }

    50% {
        box-shadow: 0 0 6px 1px rgb(212 160 23 / 20%);
    }
}

/* ── Survivors ───────────────────────────────────────────────────────────── */

.ab-survivors {
    margin: 8px 0;
}

.ab-survivors-label {
    font-size: 10px;
    font-weight: 700;
    margin-bottom: 4px;
}

.ab-survivors-grid {
    display: flex;
    gap: 4px;
    justify-content: center;
    flex-wrap: wrap;
}

/* ── Rewards ─────────────────────────────────────────────────────────────── */

.ab-rewards {
    margin: 10px 0;
    text-align: left;
}

.ab-reward {
    font-size: 11px;
    padding: 5px 10px;
    border-left: 3px solid var(--theme-color-warning);
    margin-bottom: 4px;
    background: rgb(212 160 23 / 5%);
    border-radius: 0 4px 4px 0;
    transition: background 0.15s;
}

.ab-reward:hover {
    background: rgb(212 160 23 / 10%);
}

/* ── Run Summary ─────────────────────────────────────────────────────────── */

.ab-run-summary {
    margin: 14px 0;
    text-align: left;
    background: var(--theme-surface-primary);
    border: 1px solid var(--theme-border-light);
    border-radius: 6px;
    padding: 12px;
    animation: ab-summary-enter 0.4s ease-out;
}

@keyframes ab-summary-enter {
    0% {
        opacity: 0;
        transform: translateY(8px);
    }

    100% {
        opacity: 1;
        transform: translateY(0);
    }
}

.ab-run-summary .ab-section-heading {
    margin-top: 0;
}

.ab-summary-grid {
    display: flex;
    flex-direction: column;
    gap: 4px;
}

.ab-summary-row {
    display: flex;
    justify-content: space-between;
    align-items: baseline;
    padding: 3px 0;
    font-size: 10px;
}

.ab-summary-label {
    color: var(--theme-text-secondary);
}

.ab-summary-value {
    font-weight: 700;
}

/* Animated counter for summary values */
.ab-summary-value.ab-count-up {
    transition: none;
}

.ab-summary-detail {
    font-weight: 400;
    color: var(--theme-text-secondary);
    font-size: 9px;
}

.ab-summary-divider {
    height: 1px;
    background: var(--theme-border-light);
    margin: 4px 0;
}

/* ── Action buttons ──────────────────────────────────────────────────────── */

.ab-next-btn,
.ab-return-btn {
    padding: 9px 28px;
    font-size: 12px;
    font-weight: 700;
    border: 1px solid var(--theme-border-dark);
    background: var(--theme-surface-primary);
    color: var(--theme-text-on-surface);
    border-radius: 4px;
    cursor: pointer;
    margin-top: 10px;
    transition:
        background 0.15s,
        box-shadow 0.15s,
        transform 0.15s;
}

.ab-next-btn:hover,
.ab-return-btn:hover {
    background: var(--theme-surface-secondary);
    box-shadow: 0 2px 6px rgb(0 0 0 / 12%);
    transform: translateY(-1px);
}

.ab-next-btn:active,
.ab-return-btn:active {
    transform: translateY(0) scale(0.97);
}

/* ── Drag ghost ──────────────────────────────────────────────────────────── */

.uc-drag-ghost {
    position: fixed;
    pointer-events: none;
    opacity: 0.85;
    z-index: 10000;
    transform: rotate(3deg) scale(1.08);
    box-shadow: 0 4px 12px rgb(0 0 0 / 25%);
    border-radius: 4px;
}

/* ── Combat animations ───────────────────────────────────────────────────── */

@keyframes uc-attack {
    0% {
        transform: translateX(0) scale(1);
    }

    25% {
        transform: translateX(16px) scale(1.05);
    }

    50% {
        transform: translateX(16px) scale(1.05);
    }

    100% {
        transform: translateX(0) scale(1);
    }
}

@keyframes uc-hit {
    0% {
        background-color: inherit;
        transform: translateX(0);
    }

    20% {
        background-color: rgb(255 0 0 / 35%);
        transform: translateX(-4px);
    }

    40% {
        transform: translateX(3px);
    }

    60% {
        background-color: rgb(255 0 0 / 15%);
        transform: translateX(-2px);
    }

    100% {
        background-color: inherit;
        transform: translateX(0);
    }
}

@keyframes uc-buff {
    0% {
        box-shadow: none;
    }

    30% {
        box-shadow: 0 0 10px 3px rgb(34 139 34 / 55%);
    }

    100% {
        box-shadow: none;
    }
}

@keyframes uc-summon {
    0% {
        opacity: 0;
        transform: scale(0.3) translateY(10px);
    }

    60% {
        opacity: 1;
        transform: scale(1.08) translateY(-2px);
    }

    100% {
        opacity: 1;
        transform: scale(1) translateY(0);
    }
}

@keyframes uc-damage-float {
    0% {
        opacity: 1;
        transform: translateY(0) scale(1);
    }

    100% {
        opacity: 0;
        transform: translateY(-22px) scale(0.9);
    }
}

.uc-damage-number {
    position: absolute;
    top: -4px;
    right: 4px;
    font-size: 12px;
    font-weight: 900;
    color: var(--theme-color-danger);
    animation: uc-damage-float 0.7s ease-out forwards;
    pointer-events: none;
    z-index: 5;
    text-shadow: 0 1px 2px rgb(0 0 0 / 30%);
}

/* Big damage number (>50% of target HP) */
.uc-damage-number.uc-big-hit {
    font-size: 16px;
    animation: uc-big-damage-float 0.8s ease-out forwards;
}

@keyframes uc-big-damage-float {
    0% {
        opacity: 1;
        transform: translateY(0) scale(1.3);
    }

    15% {
        transform: translateY(-2px) scale(1.4);
    }

    100% {
        opacity: 0;
        transform: translateY(-26px) scale(0.9);
    }
}

.uc-damage-number.heal {
    color: var(--theme-color-success);
}

/* Heal number with upward float */
.uc-heal-number {
    position: absolute;
    top: -4px;
    right: 4px;
    font-size: 12px;
    font-weight: 900;
    color: var(--theme-color-success);
    animation: uc-heal-float 0.7s ease-out forwards;
    pointer-events: none;
    z-index: 5;
    text-shadow: 0 0 4px rgb(34 139 34 / 40%);
}

@keyframes uc-heal-float {
    0% {
        opacity: 1;
        transform: translateY(0);
    }

    100% {
        opacity: 0;
        transform: translateY(-20px);
    }
}

/* Shield break effect */
.uc-card.uc-combat.uc-shield-break {
    animation: uc-shield-break 0.4s ease-out;
}

@keyframes uc-shield-break {
    0% {
        box-shadow: 0 0 0 0 rgb(100 149 237 / 0%);
    }

    30% {
        box-shadow: 0 0 12px 4px rgb(100 149 237 / 50%);
    }

    100% {
        box-shadow: 0 0 0 0 rgb(100 149 237 / 0%);
    }
}

/* ── Pre-run buff selection ──────────────────────────────────────────────── */

.ab-prepare {
    padding: 8px;
}

.ab-prepare h3 {
    margin: 0 0 4px;
    font-size: 14px;
    letter-spacing: 0.5px;
}

.ab-prepare-hint {
    font-size: 11px;
    color: var(--theme-text-secondary);
    margin: 0 0 10px;
}

.ab-buff-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 6px;
    margin-bottom: 10px;
}

.ab-buff-card {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 3px;
    padding: 10px 8px;
    border: 1px solid var(--theme-border-light);
    background: var(--theme-surface-primary);
    cursor: pointer;
    font-size: 10px;
    text-align: center;
    border-radius: 6px;
    position: relative;
    transition:
        border-color 0.15s,
        box-shadow 0.2s,
        transform 0.15s,
        background 0.15s;
}

.ab-buff-card:hover:not(.disabled) {
    border-color: var(--theme-accent);
    box-shadow: 0 3px 8px rgb(0 0 0 / 14%);
    transform: translateY(-2px);
}

.ab-buff-card.selected {
    border-color: var(--theme-color-success);
    background: rgb(0 204 0 / 8%);
    box-shadow:
        inset 0 0 0 1px rgb(0 204 0 / 15%),
        0 0 8px rgb(0 204 0 / 12%);
    animation: ab-buff-selected-glow 2s ease-in-out infinite;
}

@keyframes ab-buff-selected-glow {
    0%,
    100% {
        box-shadow:
            inset 0 0 0 1px rgb(0 204 0 / 15%),
            0 0 0 0 rgb(0 204 0 / 0%);
    }

    50% {
        box-shadow:
            inset 0 0 0 1px rgb(0 204 0 / 15%),
            0 0 8px 1px rgb(0 204 0 / 15%);
    }
}

.ab-buff-card.disabled {
    opacity: 0.4;
    cursor: not-allowed;
}

.ab-buff-cost.affordable {
    color: var(--theme-color-success);
}

.ab-buff-cost.too-expensive {
    color: var(--theme-color-danger);
}

.ab-buff-icon {
    font-size: 18px;
}

.ab-buff-name {
    font-weight: 700;
    font-size: 11px;
}

.ab-buff-desc {
    color: var(--theme-text-secondary);
    line-height: 1.3;
}

.ab-buff-cost {
    font-size: 9px;
    color: var(--theme-text-secondary);
    margin-top: 2px;
}

.ab-buff-check {
    position: absolute;
    top: 3px;
    right: 5px;
    font-size: 12px;
    color: var(--theme-color-success);
    font-weight: 700;
}

.ab-prepare-actions {
    display: flex;
    gap: 6px;
}

.ab-launch-btn,
.ab-back-btn {
    padding: 7px 20px;
    cursor: pointer;
    font-size: 11px;
    font-weight: 700;
    border-radius: 4px;
    transition:
        filter 0.15s,
        transform 0.1s,
        box-shadow 0.15s;
}

.ab-launch-btn {
    background: linear-gradient(135deg, #2a4a7a, #4a7ab0);
    color: white;
    border: 1px solid #1a3a6a;
    box-shadow: 0 1px 4px rgb(42 74 122 / 25%);
}

.ab-launch-btn:hover {
    filter: brightness(1.15);
    box-shadow: 0 2px 8px rgb(42 74 122 / 35%);
    transform: translateY(-1px);
}

.ab-launch-btn:active {
    transform: translateY(0) scale(0.97);
}

.ab-back-btn {
    background: var(--theme-surface-primary);
    border: 1px solid var(--theme-border-dark);
    color: var(--theme-text-on-surface);
}

.ab-back-btn:hover {
    background: var(--theme-surface-secondary);
}

.ab-back-btn:active {
    transform: scale(0.97);
}

/* ── Boss Defeated text ─────────────────────────────────────────────────── */

.ab-boss-defeated-text {
    font-size: 12px;
    font-weight: 700;
    color: #d4a017;
    margin: 4px 0 8px;
    letter-spacing: 0.5px;
    animation: ab-boss-defeated 0.6s ease-out;
}

@keyframes ab-boss-defeated {
    0% {
        opacity: 0;
        transform: scale(0.6);
    }

    50% {
        opacity: 1;
        transform: scale(1.1);
    }

    100% {
        opacity: 1;
        transform: scale(1);
    }
}

/* ── Run summary animated counters ──────────────────────────────────────── */

.ab-summary-value .ab-counter {
    display: inline;
}
